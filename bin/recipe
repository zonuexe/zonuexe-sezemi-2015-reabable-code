#!/usr/bin/env php
<?php
$recipe_file = (isset($_SERVER['argv'][1])) ? $_SERVER['argv'][1] : '';
$select_id = (isset($_SERVER['argv'][2])) ? $_SERVER['argv'][2] : 0;

is_file($recipe_file) or die('ファイルないよ'.PHP_EOL);

foreach (load_recipe($recipe_file) as $id => $recipe) {
    if ($select_id == 0 || $select_id == $id) {
      echo "{$id}: {$recipe['name']} {$recipe['url']}" . PHP_EOL;
    }
}

/**
 * @param  string $file レシピファイルのpath
 * @return array  [$id => $name] の配列
 */
function load_recipe($file)
{
    $recipes = [];
    $file = new SplFileObject($file);
    $current_id = 0;

    foreach ($file as $index => $line) {
        if (strlen($line) < 1) { break; }

        list($name, $url) = explode(' ', trim($line), 2);

        $current_id++;
        $recipes[$current_id] = ['name' => $name, 'url' => $url];
    }

    return $recipes;
}
